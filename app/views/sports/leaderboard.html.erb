<%= render 'shared/site_nav' %>

<div class="container-fluid">
    <h1 class="leaderboard-page-title text-center"> <%= @sport.name %> Leaderboard </h1>
    <div class="row justify-content-around">
      <!-- Leaderboard column -->
      <div class="col-xs-12 col-md-7">
          <h2 class="leaderboard-title">All <%= @sport.name %> Predictions Leaderboard</h2>
          <div class="table-responsive">
            <table class="table table-striped table-dark leaderboard-table soccer-tables">
              <thead>
                <tr>
                  <th scope="col">Rank</th>
                  <th scope="col">Username</th>
                  <th scope="col">Predictions</th>
                  <th scope="col">% Correct</th>
                </tr>
              </thead>
              <tbody>

              <% get_unique_users(@predictions).each do |user| %>
                <tr>
                  <td></td>
                  <td><%= user.username %></td>
                  <td><%= user.predictions.count %> </td>
                  <td><%= user.calculate_percent_correct_predictions %> </td>
                </tr>
              <% end %>
              </tbody>
            </table> <!--All sport leaderboard-->
          </div>

          <%leagues_with_predictions = @sport.leagues.select{|league| league.predictions.any?}%>
          <%leagues_with_predictions.each do |league|%>
            <h2 class="leaderboard-title"><%=league.name%> Leaderboard</h2>
            <div class="table-responsive">
              <table id="table" class="table table-striped table-dark leaderboard-table soccer-tables">
                <thead>
                  <tr>
                    <th class="rank" scope="col">Rank</th>
                    <th scope="col">Username</th>
                    <th scope="col">Predictions</th>
                    <th scope="col">% Correct</th>
                  </tr>
                </thead>
                <tbody>

                <% get_unique_users(league.predictions).each do |user| %>
                  <tr>
                    <td></td>
                    <td><%= user.username %></td>
                    <td><%= user.predictions.count %> </td>
                    <td><%= user.calculate_percent_correct_predictions %> </td>
                  </tr>
                <% end %>
                </tbody>
              </table> <!--NWSL leaderboard-->
            </div>
          <%end%>

        </div>

        <!-- Store Items -->
        <div class="col-xs-12 col-md-4">
          <div class="row justify-content-around">
            <div class="col-xs-12">
              <div class="store-item d-flex align-items-center justify-content-center">
                <h3 class="store-item-title"> Store Item </h3>
              </div>
            </div>
            <div class="col-xs-12">
              <div class="store-item d-flex align-items-center justify-content-center">
                <h3 class="store-item-title"> Store Item </h3>
              </div>
            </div>
            <div class="col-xs-12">
              <div class="store-item d-flex align-items-center justify-content-center">
                <h3 class="store-item-title"> Store Item </h3>
              </div>
            </div>
          </div>
        </div>

    </div>
</div>
